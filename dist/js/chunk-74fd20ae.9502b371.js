(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74fd20ae"],{"053b":function(t,e,n){var i=n("1e2c"),s=n("d910").f,r=Function.prototype,a=r.toString,o=/^\s*function ([^ (]*)/,c="name";i&&!(c in r)&&s(r,c,{configurable:!0,get:function(){try{return a.call(this).match(o)[1]}catch(t){return""}}})},"0965":function(t,e,n){"use strict";var i=n("5d71"),s=n.n(i);s.a},"1ab6":function(t,e,n){"use strict";var i=n("f6ed"),s=n.n(i);s.a},"21ff":function(t,e,n){"use strict";var i=n("654e"),s=n.n(i);s.a},"2ec4":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"view-layout"},[t.isNotPublish?n("div",{staticClass:"main"},[t._m(0),t._m(1)]):t.isExpired?n("div",{staticClass:"main"},[t._m(2),t._m(3)]):t.naire?n("div",{staticClass:"main"},[n("div",{staticClass:"header"},[n("h1",[t._v(t._s(t.naire.title))])]),n("div",{staticClass:"content"},[n("div",{staticClass:"intro"},[n("div",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.naire.intro))]),n("p",{staticClass:"mt-10"},[t._v("截止日期："+t._s(t._f("formatTime")(t.naire.deadline)))])]),n("div",{staticClass:"user-info"},[n("el-alert",{attrs:{type:t.isLogin?"success":"warning"}},[t._v(t._s(t.loginTip))]),n("el-form",{directives:[{name:"show",rawName:"v-show",value:!t.isLogin,expression:"!isLogin"}],ref:"userInfo",staticClass:"mt-10",attrs:{model:t.userInfo,rules:t.userInfoRule,inline:""}},[n("el-form-item",{attrs:{prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.userInfo.name,callback:function(e){t.$set(t.userInfo,"name",e)},expression:"userInfo.name"}})],1),n("el-form-item",{attrs:{prop:"identity"}},[n("el-input",{attrs:{placeholder:"请输入身份证后6位"},model:{value:t.userInfo.identity,callback:function(e){t.$set(t.userInfo,"identity",e)},expression:"userInfo.identity"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("点击登录")])],1)],1)],1),n("question-list",{attrs:{"question-list":t.naire.topic}}),n("div",{staticClass:"text-center"},[t.isAdmin?n("el-button",{attrs:{type:"success"},on:{click:t.goBack}},[t._v("返回管理平台 ")]):t._e(),n("el-button",{attrs:{type:"primary",loading:t.finished,disabled:t.finished},on:{click:t.submitNaire}},[t._v("提交问卷")])],1)],1),t._m(4)]):t._e()])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("h1",[t._v("问卷未发布！")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("p",[t._v("您所填写的问卷未发布，暂不能填写。")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("h1",[t._v("问卷已过期！")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("p",[t._v("您所填写的问卷已到截止日期，暂不能填写。")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"footer"},[n("p",[t._v("犀牛问卷系统")])])}],r=(n("fe59"),n("d497"),n("053b"),n("513c"),n("6db4"),n("08ba"),n("6a61"),n("cf7f")),a=n("1462"),o=n("a340"),c=n("bb06"),u=n("9691"),l=n("0372"),d=n("e4a1"),p=n("9dba"),f=n("3ec7"),h=n("ea9b"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.questionList&&0===t.questionList.length?n("div",{staticClass:"no-question"},[t._v(" 一点东西都没有，赶快点击上方按钮添加题目吧！ ")]):t._e(),t._l(t.questionList,(function(e,i){return n("div",{key:i,class:["question-item",t.type]},[n("div",{staticClass:"question-order"},[n("div",{staticClass:"title"},[t._v(" Q"+t._s(i+1)+"： ["+t._s(e.type)+"] "+t._s(e.question)),e.selectMultipleContent&&e.setting.last>0?n("span",[t._v(" (必选 "+t._s(e.setting.last)+" 项，已勾选 "+t._s(e.selectMultipleContent.length)+" 项)")]):t._e(),e.isRequired?n("span",{staticStyle:{color:"#f00"}},[t._v("*")]):t._e()]),""!==e.description?n("p",{staticClass:"question-desc"},[t._v("说明："+t._s(e.description))]):t._e()]),n("div",{staticClass:"question-content"},[n("question-item",t._g({attrs:{type:e.type,topic:e,index:i}},t.$listeners))],1)])}))],2)},v=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.componentName,t._g(t._b({tag:"component"},"component",t.$attrs,!1),t.$listeners))},b=[],g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-radio-group",{staticClass:"radio-list",attrs:{vertica:""},model:{value:t.topic.selectContent,callback:function(e){t.$set(t.topic,"selectContent",e)},expression:"topic.selectContent"}},t._l(t.topic.options,(function(e,i){return n("el-radio",{key:i,staticClass:"option-item",attrs:{label:e.o_id}},[n("span",[t._v(t._s(e.content))]),e.isAddition?n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isAddition&&t.topic.selectContent===e.o_id,expression:"option.isAddition && topic.selectContent === option.o_id "}],staticClass:"addition-input",staticStyle:{width:"300px"},attrs:{placeholder:"请输入理由",size:"mini"},model:{value:t.topic.additional,callback:function(e){t.$set(t.topic,"additional",e)},expression:"topic.additional"}}):t._e(),n("div",{staticClass:"option-desc",domProps:{textContent:t._s(e.desc)}})],1)})),1)],1)},y=[],C=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return n}(d["c"]);l["a"]([Object(d["b"])({required:!0})],C.prototype,"topic",void 0),l["a"]([Object(d["b"])({required:!0})],C.prototype,"index",void 0),C=l["a"]([d["a"]],C);var j=C,O=j,k=(n("1ab6"),n("9ca4")),x=Object(k["a"])(O,g,y,!1,null,"2c89563e",null),I=x.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-checkbox-group",{staticClass:"checkbox-list",model:{value:t.topic.selectMultipleContent,callback:function(e){t.$set(t.topic,"selectMultipleContent",e)},expression:"topic.selectMultipleContent"}},t._l(t.topic.options,(function(e,i){return n("el-checkbox",{key:i,staticClass:"option-item",attrs:{label:e.o_id}},[n("span",[t._v(t._s(e.content))]),n("div",{class:["option-desc"],domProps:{textContent:t._s(e.desc)}})])})),1)],1)},T=[],$=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return n}(d["c"]);l["a"]([Object(d["b"])({required:!0})],$.prototype,"topic",void 0),l["a"]([Object(d["b"])({required:!0})],$.prototype,"index",void 0),$=l["a"]([d["a"]],$);var E=$,q=E,L=(n("6f9a"),Object(k["a"])(q,w,T,!1,null,"52b9b6d3",null)),N=L.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-20 mb-20"},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入..."},model:{value:t.topic.selectContent,callback:function(e){t.$set(t.topic,"selectContent",e)},expression:"topic.selectContent"}})],1)},S=[],M=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return n}(d["c"]);l["a"]([Object(d["b"])({required:!0})],M.prototype,"topic",void 0),l["a"]([Object(d["b"])({required:!0})],M.prototype,"index",void 0),M=l["a"]([d["a"]],M);var R=M,F=R,A=Object(k["a"])(F,U,S,!1,null,"4f5fa006",null),Q=A.exports,P=n("5d15"),H=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"componentName",get:function(){return this.type===P["a"].SINGLE_CHOICE?"SingleChoice":this.type===P["a"].MULTIPLE_CHOICE?"MultiChoice":this.type===P["a"].TEXT_QUESTION?"TextQuestion":void 0}}]),n}(d["c"]);l["a"]([Object(d["b"])()],H.prototype,"type",void 0),H=l["a"]([Object(d["a"])({components:{SingleChoice:I,MultiChoice:N,TextQuestion:Q}})],H);var D=H,G=D,X=Object(k["a"])(G,_,b,!1,null,null,null),z=X.exports,B=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return n}(d["c"]);l["a"]([Object(d["b"])()],B.prototype,"questionList",void 0),l["a"]([Object(d["b"])({default:"normal"})],B.prototype,"type",void 0),B=l["a"]([Object(d["a"])({components:{QuestionItem:z}})],B);var J=B,K=J,V=(n("0965"),Object(k["a"])(K,m,v,!1,null,"67ee4b53",null)),W=V.exports,Y=function(t){Object(c["a"])(n,t);var e=Object(u["a"])(n);function n(){var t;return Object(a["a"])(this,n),t=e.apply(this,arguments),t.loading=!1,t.naire=null,t.isLogin=!1,t.userId="",t.userInfo={name:"",identity:""},t.userInfoRule={name:[{required:!0,message:"请填写用户名",trigger:"blur"}],identity:[{required:!0,message:"请填写身份证后6位",trigger:"blur"}]},t.finished=!1,t}return Object(o["a"])(n,[{key:"watchRoute",value:function(){this.fetchData()}},{key:"goBack",value:function(){this.$router.push("/list")}},{key:"handleSubmit",value:function(){var t=this,e=this.$refs["userInfo"];e.validate(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,h["e"]({naire_id:t.naire.naire_id,name:t.userInfo.name,identity:t.userInfo.identity.toUpperCase()});case 4:i=e.sent,i.success?(t.isLogin=!0,t.userId=i.data.user_id,i.data.isFinished?(t.$notify({title:"已完成问卷",message:"您已完成该问卷，请勿重复提交！",type:"warning"}),t.$router.push("/complete")):t.$notify({title:"欢迎您 "+i.data.name,message:"请继续完成问卷内容吧！",type:"success"})):t.$message.error("用户登录失败，请重试");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"validateNaire",value:function(){var t=!0,e=!1;return this.naire.topic.forEach((function(n,i){if(n.isRequired){if(n.type===P["a"].TEXT_QUESTION&&(n.selectContent&&n.selectContent.trim().length>0||(t=!1)),n.type===P["a"].SINGLE_CHOICE){var s=n.options&&n.options.some((function(t,e){return t.isAddition&&t.o_id===n.selectContent}));!s||n.additional&&n.additional.trim().length>0||(e=!0),n.selectContent&&n.selectContent.trim().length>0||(t=!1)}n.type===P["a"].MULTIPLE_CHOICE&&(n.selectMultipleContent&&n.selectMultipleContent.length>0||(t=!1),n.setting.last&&n.setting.last>0&&n.selectMultipleContent&&n.selectMultipleContent.length!==Number(n.setting.last)&&(t=!1))}})),t?e?(this.$notify.warning({title:"提示",message:"请填写附加理由",type:"warning"}),!1):!!this.isLogin||(this.$notify.warning({title:"提示",message:"请先填写用户信息",type:"warning"}),!1):(this.$notify.warning({title:"提示",message:"您还有必填项未正确填写，请检查后提交！",type:"warning"}),!1)}},{key:"submitNaire",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.validateNaire()){t.next=2;break}return t.abrupt("return");case 2:return this.finished=!0,e=this.naire.naire_id,n=[],this.naire.topic.forEach((function(t,i){if("单选"===t.type){var r={naire_id:e,user_id:s.userId,q_id:t.q_id,o_id:t.selectContent,o_addition:t.additional?t.additional.trim():""};n.push(r)}else if("多选"===t.type){var a={naire_id:e,user_id:s.userId,q_id:t.q_id,o_id:t.selectMultipleContent,o_addition:t.additional?t.additional.trim():""};n.push(a)}else{var o={naire_id:e,user_id:s.userId,q_id:t.q_id,o_id:"",o_addition:t.selectContent?t.selectContent.trim():""};n.push(o)}})),t.next=8,f["k"]({nId:e,result:n,userId:this.userId});case 8:i=t.sent,this.finished=!1,console.log(i),i.success?(this.$message.success(i.msg),this.$router.push("/complete")):this.$message.error("提交失败，错误信息："+i.msg);case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"fetchData",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,f["f"]({naire_id:this.$route.params.id,type:"normal"});case 3:e=t.sent,this.loading=!1,e.success&&(this.naire=e.data,document.title=e.data.title);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){this.fetchData()}},{key:"loginTip",get:function(){return this.isLogin?"当前登录用户：".concat(this.userInfo.name,"，请继续完成问卷！"):"在填写表单之前，请先填写用户信息。"}},{key:"isAdmin",get:function(){return p["a"].isAdmin}},{key:"isNotPublish",get:function(){return!this.isAdmin&&"0"===this.naire.status}},{key:"isExpired",get:function(){return!this.isAdmin&&Number(this.naire.deadline)<(new Date).getTime()}}]),n}(d["c"]);l["a"]([Object(d["d"])("$route")],Y.prototype,"watchRoute",null),Y=l["a"]([Object(d["a"])({components:{QuestionList:W}})],Y);var Z=Y,tt=Z,et=(n("21ff"),Object(k["a"])(tt,i,s,!1,null,"1085abc2",null));e["default"]=et.exports},"3ec7":function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"c",(function(){return r})),n.d(e,"j",(function(){return a})),n.d(e,"i",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"k",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"l",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"e",(function(){return m}));var i=n("b32d"),s=function(){return i["a"].get("/naire",{})},r=function(t){return i["a"].post("/naire/save",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},a=function(t){return i["a"].post("/naire/statis",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},o=function(t){return i["a"].get("/naire/sourcedata",t)},c=function(t){return i["a"].post("/naire/crossanalysis",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},u=function(t){return i["a"].post("/naire/questions",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},l=function(t){return i["a"].post("/naire/detail",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},d=function(t){return i["a"].post("/naire/submit",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},p=function(t){return i["a"].get("/naire/changeStatus",t)},f=function(t){return i["a"].get("/naire/submitStatis",t)},h=function(t){return i["a"].post("/naire/changeTime",t)},m=function(t){return i["a"].get("/naire/del",t)}},"5d15":function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t["SINGLE_CHOICE"]="单选",t["MULTIPLE_CHOICE"]="多选",t["TEXT_QUESTION"]="文本"}(i||(i={}))},"5d71":function(t,e,n){},"654e":function(t,e,n){},"6db4":function(t,e,n){"use strict";var i=n("1c8b"),s=n("c10f").trim,r=n("f221");i({target:"String",proto:!0,forced:r("trim")},{trim:function(){return s(this)}})},"6f9a":function(t,e,n){"use strict";var i=n("d846"),s=n.n(i);s.a},d497:function(t,e,n){"use strict";var i=n("1c8b"),s=n("5dfd").some,r=n("d7e1"),a=n("ff9c"),o=r("some"),c=a("some");i({target:"Array",proto:!0,forced:!o||!c},{some:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},d846:function(t,e,n){},ea9b:function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return l}));var i=n("b32d"),s=function(t){return i["a"].post("/user/getId",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},r=function(t){return i["a"].post("/user/addUser",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},a=function(t){return i["a"].post("/user/updateUser",t,{headers:{"Content-Type":"application/json; charset=UTF-8"}})},o=function(){return i["a"].get("/user/getClass")},c=function(t){return i["a"].get("/user",t)},u=function(t){return i["a"].post("/user/del",t)},l=function(){return i["a"].post("/user/clear")}},f221:function(t,e,n){var i=n("efe2"),s=n("fc8c"),r="​᠎";t.exports=function(t){return i((function(){return!!s[t]()||r[t]()!=r||s[t].name!==t}))}},f6ed:function(t,e,n){}}]);
//# sourceMappingURL=chunk-74fd20ae.9502b371.js.map
