(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80a71d1a"],{"1c87":function(e,t,n){},"96bc":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"create"},[n("el-alert",{staticClass:"mb-20",attrs:{type:"error"}},[e._v("编辑问卷会清空已有的统计数据，请确保问卷在未发布的情况下进行修改。")]),n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"}},[n("el-form-item",{attrs:{label:"问卷名称",prop:"title"}},[n("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),n("el-form-item",{attrs:{label:"问卷介绍",prop:"intro"}},[n("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),n("div",{staticClass:"add-option"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.SINGLE_CHOICE)}}},[e._v("单选题")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.MULTIPLE_CHOICE)}}},[e._v("多选题")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.TEXT_QUESTION)}}},[e._v("文本题")])],1),n("question-list",{attrs:{"question-list":e.form.topic},on:{delQuestion:e.onDelQuestion,addOption:e.onAddOption,delOption:e.onDelOption}}),n("el-form-item",{attrs:{label:"截止时间",prop:"deadline"}},[n("el-date-picker",{attrs:{type:"datetime","picker-options":e.datePickerOptions,placeholder:"选择日期时间"},model:{value:e.form.deadline,callback:function(t){e.$set(e.form,"deadline",t)},expression:"form.deadline"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"default"},on:{click:function(t){return e.submitNaire(e.NaireStatus.UNPUBLISHED)}}},[e._v("保存问卷")]),n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submitNaire(e.NaireStatus.PUBLISHED)}}},[e._v("发布问卷")])],1)],1)],1)},r=[],a=(n("ea69"),n("513c"),n("6a61"),n("cf7f")),o=n("e793"),s=n("1462"),c=n("a340"),u=n("bb06"),l=n("9691"),d=n("0372"),p=n("e4a1"),f=n("cf24"),m=n.n(f),b=n("3ec7"),v=n("5d15"),h=n("f6b1"),g=n("9bcc"),k=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.questionType=v["a"],e.NaireStatus=h["a"],e.form={title:"",intro:"",deadline:"",status:0,options:"",topic:[]},e.loading=!1,e.rules={title:[{required:!0,message:"请输入问卷标题",trigger:"blur"}],deadline:[{required:!0,message:"请选择截止时间",trigger:"blur"}]},e.datePickerOptions={disabledDate:function(e){return e.getTime()<m()().add(-1,"day").valueOf()}},e}return Object(c["a"])(n,[{key:"onAddOption",value:function(e){var t=e.index,n={content:"选项",isAddition:!1,image:"",desc:""};this.form.topic[t].options.push(Object(o["a"])({},n))}},{key:"onDelOption",value:function(e){var t=e.index,n=e.opIndex;if(this.form.topic[t].options.length<2)return this.$message.warning("已经是最后一个选项，无法删除。");this.form.topic[t].options.splice(n,1)}},{key:"onDelQuestion",value:function(e){var t=e.index;this.form.topic.splice(t,1)}},{key:"addOption",value:function(e){switch(e){case v["a"].SINGLE_CHOICE:var t={question:"单选题目",options:[{content:"选项",isAddition:!1,image:"",desc:""}],description:"",type:"单选",isRequired:!0,selectContent:"",setting:{last:1},additional:""};this.form.topic.push(t);break;case v["a"].MULTIPLE_CHOICE:var n={question:"多选题目",options:[{content:"选项",isAddition:!1,image:"",desc:""}],description:"",type:"多选",isRequired:!0,setting:{last:1},selectMultipleContent:[]};this.form.topic.push(n);break;case v["a"].TEXT_QUESTION:var i={question:"文本题目",description:"",type:"文本",isRequired:!0,setting:{},selectContent:""};this.form.topic.push(i);break}}},{key:"submitNaire",value:function(e){var t=this,n=this.$refs.form;n.validate(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(0!==t.form.topic.length){e.next=4;break}return e.abrupt("return",t.$message.warning("请至少添加一道题目。"));case 4:return i={naire:Object(o["a"])(Object(o["a"])({},t.form),{},{deadline:new Date(t.form.deadline).getTime()}),status:"update"},t.loading=!0,e.next=8,b["c"](i);case 8:if(r=e.sent,t.loading=!1,!r.success){e.next=16;break}return t.$message.success("修改问卷成功！"),e.next=14,t.$router.push("/list");case 14:e.next=17;break;case 16:t.$message.error(r.msg);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"fetchData",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,b["f"]({n_id:this.$route.params.id,type:"normal"});case 3:t=e.sent,this.loading=!1,t.success&&(this.form=Object(o["a"])(Object(o["a"])({},t.data),{},{deadline:new Date(Number(t.data.deadline))}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){this.fetchData()}}]),n}(p["c"]);k=d["a"]([Object(p["a"])({components:{QuestionList:g["a"]}})],k);var O=k,y=O,w=(n("f890"),n("9ca4")),x=Object(w["a"])(y,i,r,!1,null,"f93f6fc4",null);t["default"]=x.exports},f890:function(e,t,n){"use strict";var i=n("1c87"),r=n.n(i);r.a}}]);
//# sourceMappingURL=chunk-80a71d1a.9bc404f4.js.map