{"version":3,"sources":["webpack:///./src/views/edit/edit.vue?bfea","webpack:///./src/views/edit/edit.vue","webpack:///./src/views/edit/edit.vue?ab6f","webpack:///./src/views/edit/edit.vue?a437","webpack:///./src/views/edit/edit.vue?9d1b"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","modifiers","staticClass","attrs","_v","ref","form","rules","model","callback","$$v","$set","on","$event","addOption","questionType","SINGLE_CHOICE","MULTIPLE_CHOICE","TEXT_QUESTION","topic","onDelQuestion","onAddOption","onDelOption","datePickerOptions","submitNaire","NaireStatus","UNPUBLISHED","PUBLISHED","staticRenderFns","title","intro","deadline","status","options","loading","required","message","trigger","disabledDate","time","getTime","add","valueOf","index","tempData","content","isAddition","image","desc","push","opIndex","length","$message","warning","splice","type","radioQues","question","description","isRequired","selectContent","setting","last","additional","checkboxQues","selectMultipleContent","textareaQues","$refs","validate","valid","params","naire","Date","res","success","$router","error","msg","n_id","$route","id","data","Number","fetchData","components","QuestionList","component"],"mappings":"kJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,4BAA4BC,MAAOT,EAAW,QAAEU,WAAW,UAAUC,UAAU,CAAC,YAAa,EAAK,MAAO,KAAQC,YAAY,UAAU,CAACR,EAAG,WAAW,CAACQ,YAAY,QAAQC,MAAM,CAAC,KAAO,UAAU,CAACb,EAAIc,GAAG,uCAAuCV,EAAG,UAAU,CAACW,IAAI,OAAOF,MAAM,CAAC,MAAQb,EAAIgB,KAAK,MAAQhB,EAAIiB,MAAM,iBAAiB,QAAQ,cAAc,UAAU,CAACb,EAAG,eAAe,CAACS,MAAM,CAAC,MAAQ,OAAO,KAAO,UAAU,CAACT,EAAG,WAAW,CAACc,MAAM,CAACT,MAAOT,EAAIgB,KAAU,MAAEG,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIgB,KAAM,QAASI,IAAMV,WAAW,iBAAiB,GAAGN,EAAG,eAAe,CAACS,MAAM,CAAC,MAAQ,OAAO,KAAO,UAAU,CAACT,EAAG,WAAW,CAACS,MAAM,CAAC,KAAO,WAAW,KAAO,KAAKK,MAAM,CAACT,MAAOT,EAAIgB,KAAU,MAAEG,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIgB,KAAM,QAASI,IAAMV,WAAW,iBAAiB,GAAGN,EAAG,MAAM,CAACQ,YAAY,cAAc,CAACR,EAAG,YAAY,CAACS,MAAM,CAAC,KAAO,WAAWS,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOvB,EAAIwB,UAAUxB,EAAIyB,aAAaC,kBAAkB,CAAC1B,EAAIc,GAAG,SAASV,EAAG,YAAY,CAACS,MAAM,CAAC,KAAO,WAAWS,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOvB,EAAIwB,UAAUxB,EAAIyB,aAAaE,oBAAoB,CAAC3B,EAAIc,GAAG,SAASV,EAAG,YAAY,CAACS,MAAM,CAAC,KAAO,WAAWS,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOvB,EAAIwB,UAAUxB,EAAIyB,aAAaG,kBAAkB,CAAC5B,EAAIc,GAAG,UAAU,GAAGV,EAAG,gBAAgB,CAACS,MAAM,CAAC,gBAAgBb,EAAIgB,KAAKa,OAAOP,GAAG,CAAC,YAActB,EAAI8B,cAAc,UAAY9B,EAAI+B,YAAY,UAAY/B,EAAIgC,eAAe5B,EAAG,eAAe,CAACS,MAAM,CAAC,MAAQ,OAAO,KAAO,aAAa,CAACT,EAAG,iBAAiB,CAACS,MAAM,CAAC,KAAO,WAAW,iBAAiBb,EAAIiC,kBAAkB,YAAc,UAAUf,MAAM,CAACT,MAAOT,EAAIgB,KAAa,SAAEG,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIgB,KAAM,WAAYI,IAAMV,WAAW,oBAAoB,GAAGN,EAAG,eAAe,CAACA,EAAG,YAAY,CAACS,MAAM,CAAC,KAAO,WAAWS,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOvB,EAAIkC,YAAYlC,EAAImC,YAAYC,gBAAgB,CAACpC,EAAIc,GAAG,UAAUV,EAAG,YAAY,CAACS,MAAM,CAAC,KAAO,WAAWS,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOvB,EAAIkC,YAAYlC,EAAImC,YAAYE,cAAc,CAACrC,EAAIc,GAAG,WAAW,IAAI,IAAI,IAChnEwB,EAAkB,G,qMCgED,EAArB,wDALA,iD,0BAMU,EAAAb,aAAeA,EAAA,KACf,EAAAU,YAAc,OACd,EAAAnB,KAA4B,CAClCuB,MAAO,GACPC,MAAO,GACPC,SAAU,GACVC,OAAQ,EACRC,QAAS,GACTd,MAAO,IAED,EAAAe,SAAmB,EACnB,EAAA3B,MAAQ,CACdsB,MAAO,CACL,CAAEM,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAEjDN,SAAU,CACR,CAAEI,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAI3C,EAAAd,kBAAoB,CAC1Be,aAD0B,SACZC,GACZ,OAAOA,EAAKC,UAAY,MAAQC,KAAK,EAAG,OAAOC,YA5BrD,EAKA,8DA2BmD,IAA1BC,EAA0B,EAA1BA,MACfC,EAAW,CACfC,QAAS,KACTC,YAAY,EACZC,MAAO,GACPC,KAAM,IAERzD,KAAKe,KAAKa,MAAMwB,GAAOV,QAASgB,KAAhC,kBAA0CL,MAlC9C,qCAqC6E,IAApDD,EAAoD,EAApDA,MAAOO,EAA6C,EAA7CA,QAC5B,GAAI3D,KAAKe,KAAKa,MAAMwB,GAAOV,QAASkB,OAAS,EAC3C,OAAO5D,KAAK6D,SAASC,QAAQ,mBAE/B9D,KAAKe,KAAKa,MAAMwB,GAAOV,QAASqB,OAAOJ,EAAS,KAzCpD,uCA4CqD,IAA1BP,EAA0B,EAA1BA,MACvBpD,KAAKe,KAAKa,MAAMmC,OAAOX,EAAO,KA7ClC,gCAgDaY,GACT,OAAQA,GACN,KAAKxC,EAAA,KAAaC,cAChB,IAAMwC,EAAY,CAChBC,SAAU,OACVxB,QAAS,CACP,CACEY,QAAS,KACTC,YAAY,EACZC,MAAO,GACPC,KAAM,KAGVU,YAAa,GACbH,KAAM,KACNI,YAAY,EACZC,cAAe,GACfC,QAAS,CACPC,KAAM,GAERC,WAAY,IAEdxE,KAAKe,KAAKa,MAAM8B,KAAKO,GACrB,MACF,KAAKzC,EAAA,KAAaE,gBAChB,IAAM+C,EAAe,CACnBP,SAAU,OACVxB,QAAS,CACP,CACEY,QAAS,KACTC,YAAY,EACZC,MAAO,GACPC,KAAM,KAGVU,YAAa,GACbH,KAAM,KACNI,YAAY,EACZE,QAAS,CACPC,KAAM,GAERG,sBAAuB,IAEzB1E,KAAKe,KAAKa,MAAM8B,KAAKe,GACrB,MACF,KAAKjD,EAAA,KAAaG,cAChB,IAAMgD,EAAe,CACnBT,SAAU,OACVC,YAAa,GACbH,KAAM,KACNI,YAAY,EACZE,QAAS,GACTD,cAAe,IAEjBrE,KAAKe,KAAKa,MAAM8B,KAAKiB,GACrB,SAvGR,kCA2GeX,GAAiB,WACtBjD,EAAOf,KAAK4E,MAAM7D,KACxBA,EAAK8D,SAAL,yDAAc,WAAOC,GAAP,4FACPA,EADO,oDAEmB,IAA3B,EAAK/D,KAAKa,MAAMgC,OAFR,yCAGH,EAAKC,SAASC,QAAQ,eAHnB,cAKNiB,EAAS,CACbC,MAAO,iCACF,EAAKjE,MADL,IAEHyB,SAAU,IAAIyC,KAAK,EAAKlE,KAAKyB,UAAUS,YAEzCR,OAAQ,UAEV,EAAKE,SAAU,EAZH,SAaM,OAAmBoC,GAbzB,UAaNG,EAbM,OAcZ,EAAKvC,SAAU,GACXuC,EAAIC,QAfI,wBAgBV,EAAKtB,SAASsB,QAAQ,WAhBZ,UAiBJ,EAAKC,QAAQ1B,KAAK,SAjBd,gCAmBV,EAAKG,SAASwB,MAAMH,EAAII,KAnBd,4CAAd,yDA7GJ,2LAsIItF,KAAK2C,SAAU,EAtInB,SAuIsB,OAAmB,CACnC4C,KAAMvF,KAAKwF,OAAOT,OAAOU,GACzBzB,KAAM,WAzIZ,OAuIUkB,EAvIV,OA2IIlF,KAAK2C,SAAU,EACXuC,EAAIC,UACNnF,KAAKe,KAAL,iCACKmE,EAAIQ,MADT,IAEElD,SAAU,IAAIyC,KAAKU,OAAOT,EAAIQ,KAAKlD,cA/I3C,yIAqJIxC,KAAK4F,gBArJT,GAAoC,QAAf,EAAM,QAL1B,eAAU,CACTC,WAAY,CACVC,eAAA,SAGiB,WCjEif,I,wBCQlgBC,EAAY,eACd,EACAjG,EACAuC,GACA,EACA,KACA,WACA,MAIa,aAAA0D,E,2CCnBf,yBAA0sB,EAAG","file":"js/chunk-80a71d1a.9bc404f4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading.fullscreen.lock\",value:(_vm.loading),expression:\"loading\",modifiers:{\"fullscreen\":true,\"lock\":true}}],staticClass:\"create\"},[_c('el-alert',{staticClass:\"mb-20\",attrs:{\"type\":\"error\"}},[_vm._v(\"编辑问卷会清空已有的统计数据，请确保问卷在未发布的情况下进行修改。\")]),_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-position\":\"right\",\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"问卷名称\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"问卷介绍\",\"prop\":\"intro\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":\"5\"},model:{value:(_vm.form.intro),callback:function ($$v) {_vm.$set(_vm.form, \"intro\", $$v)},expression:\"form.intro\"}})],1),_c('div',{staticClass:\"add-option\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.SINGLE_CHOICE)}}},[_vm._v(\"单选题\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.MULTIPLE_CHOICE)}}},[_vm._v(\"多选题\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.TEXT_QUESTION)}}},[_vm._v(\"文本题\")])],1),_c('question-list',{attrs:{\"question-list\":_vm.form.topic},on:{\"delQuestion\":_vm.onDelQuestion,\"addOption\":_vm.onAddOption,\"delOption\":_vm.onDelOption}}),_c('el-form-item',{attrs:{\"label\":\"截止时间\",\"prop\":\"deadline\"}},[_c('el-date-picker',{attrs:{\"type\":\"datetime\",\"picker-options\":_vm.datePickerOptions,\"placeholder\":\"选择日期时间\"},model:{value:(_vm.form.deadline),callback:function ($$v) {_vm.$set(_vm.form, \"deadline\", $$v)},expression:\"form.deadline\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"default\"},on:{\"click\":function($event){return _vm.submitNaire(_vm.NaireStatus.UNPUBLISHED)}}},[_vm._v(\"保存问卷\")]),_c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":function($event){return _vm.submitNaire(_vm.NaireStatus.PUBLISHED)}}},[_vm._v(\"发布问卷\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator'\nimport dayjs from 'dayjs'\nimport { Form as ElForm } from 'element-ui'\n\nimport * as NaireAction from '@/api/naire'\n\nimport { questionType, questionTypeText } from '@/config/enum/questionType'\nimport { NaireStatus } from '@/config/enum/naireStatus'\n\nimport QuestionList from '@/components/Question/QuestionList.vue'\n\n@Component({\n  components: {\n    QuestionList\n  }\n})\nexport default class NavBar extends Vue {\n  private questionType = questionType\n  private NaireStatus = NaireStatus\n  private form:Questionnaire.INaire = {\n    title: '',\n    intro: '',\n    deadline: '',\n    status: 0,\n    options: '',\n    topic: []\n  }\n  private loading: boolean = false\n  private rules = {\n    title: [\n      { required: true, message: '请输入问卷标题', trigger: 'blur' }\n    ],\n    deadline: [\n      { required: true, message: '请选择截止时间', trigger: 'blur' }\n    ]\n  }\n\n  private datePickerOptions = {\n    disabledDate (time: Date) {\n      return time.getTime() < dayjs().add(-1, 'day').valueOf()\n    }\n  }\n\n  private onAddOption ({ index }: { index: number }) {\n    const tempData = {\n      content: '选项',\n      isAddition: false,\n      image: '', // 选项图片\n      desc: ''\n    }\n    this.form.topic[index].options!.push({ ...tempData })\n  }\n\n  private onDelOption ({ index, opIndex }: { index: number, opIndex: number }) {\n    if (this.form.topic[index].options!.length < 2) {\n      return this.$message.warning('已经是最后一个选项，无法删除。')\n    }\n    this.form.topic[index].options!.splice(opIndex, 1)\n  }\n\n  private onDelQuestion ({ index }: { index: number }) {\n    this.form.topic.splice(index, 1)\n  }\n\n  addOption (type: questionTypeText) {\n    switch (type) {\n      case questionType.SINGLE_CHOICE:\n        const radioQues = {\n          question: '单选题目',\n          options: [\n            {\n              content: '选项',\n              isAddition: false,\n              image: '',\n              desc: ''\n            }\n          ],\n          description: '',\n          type: '单选',\n          isRequired: true,\n          selectContent: '',\n          setting: {\n            last: 1\n          },\n          additional: ''\n        }\n        this.form.topic.push(radioQues)\n        break\n      case questionType.MULTIPLE_CHOICE:\n        const checkboxQues = {\n          question: '多选题目',\n          options: [\n            {\n              content: '选项',\n              isAddition: false,\n              image: '',\n              desc: ''\n            }\n          ],\n          description: '',\n          type: '多选',\n          isRequired: true,\n          setting: {\n            last: 1 // 最少选择几项\n          },\n          selectMultipleContent: []\n        }\n        this.form.topic.push(checkboxQues)\n        break\n      case questionType.TEXT_QUESTION:\n        const textareaQues = {\n          question: '文本题目',\n          description: '',\n          type: '文本',\n          isRequired: true,\n          setting: {},\n          selectContent: ''\n        }\n        this.form.topic.push(textareaQues)\n        break\n    }\n  }\n\n  submitNaire (type: NaireStatus) {\n    const form = this.$refs.form as ElForm\n    form.validate(async (valid) => {\n      if (!valid) return\n      if (this.form.topic.length === 0) {\n        return this.$message.warning('请至少添加一道题目。')\n      }\n      const params = {\n        naire: {\n          ...this.form,\n          deadline: new Date(this.form.deadline).getTime()\n        },\n        status: 'update'\n      }\n      this.loading = true\n      const res = await NaireAction.create(params)\n      this.loading = false\n      if (res.success) {\n        this.$message.success('修改问卷成功！')\n        await this.$router.push('/list')\n      } else {\n        this.$message.error(res.msg)\n      }\n    })\n  }\n\n  async fetchData () {\n    this.loading = true\n    const res = await NaireAction.detail({\n      n_id: this.$route.params.id,\n      type: 'normal'\n    })\n    this.loading = false\n    if (res.success) {\n      this.form = {\n        ...res.data,\n        deadline: new Date(Number(res.data.deadline))\n      }\n    }\n  }\n\n  mounted () {\n    this.fetchData()\n  }\n}\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../../node_modules/_ts-loader@6.2.2@ts-loader/index.js??ref--14-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../../node_modules/_ts-loader@6.2.2@ts-loader/index.js??ref--14-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./edit.vue?vue&type=template&id=f93f6fc4&scoped=true&\"\nimport script from \"./edit.vue?vue&type=script&lang=ts&\"\nexport * from \"./edit.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./edit.vue?vue&type=style&index=0&id=f93f6fc4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f93f6fc4\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=style&index=0&id=f93f6fc4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=style&index=0&id=f93f6fc4&lang=scss&scoped=true&\""],"sourceRoot":""}